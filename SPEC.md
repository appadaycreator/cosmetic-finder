# Cosmetic Finder 仕様書

## プロジェクト概要

**名称**: Cosmetic Finder (コスメファインダー)  
**バージョン**: 3.0.0  
**最終更新日**: 2025年1月25日

### 目的
ユーザーの肌質を診断し、化粧品の成分を解析することで、個人に最適な化粧品選びをサポートするWebアプリケーション。

## 機能仕様

### 1. 肌質診断機能

#### 概要
10項目の詳細な質問によりユーザーの肌質を診断し、パーソナライズされた推奨事項を提供。

#### 診断フロー
1. 肌質タイプ（乾燥肌、脂性肌、混合肌、敏感肌、普通肌）
2. 年齢層（10代、20代、30代、40代、50代以上）
3. 主な肌の悩み（ニキビ、シワ、シミ、毛穴、特になし）
4. 肌の敏感度（とても敏感、やや敏感、普通、丈夫）
5. 生活環境（都市部、郊外、田舎、海沿い）
6. スキンケア時間（最小限、適度、しっかり）
7. 化粧品予算（〜3,000円、3,000円〜10,000円、10,000円〜20,000円、20,000円以上）
8. 成分へのこだわり（天然・オーガニック、科学的効果、低刺激性、こだわりなし）
9. テクスチャー好み（さっぱり、しっとり、ジェル状、こだわりなし）
10. 香りの好み（無香料、天然の香り、軽い香り、こだわりなし）

#### 診断結果
- 肌タイプの判定
- パーソナライズされた説明文
- スキンケア推奨事項（3-5項目）
- おすすめ製品カテゴリー
- AIスコアリングによる製品推奨
- 診断履歴の保存（最大10件）

### 2. 成分解析機能

#### 概要
化粧品の成分リストを入力し、各成分の安全性と効果を解析。

#### 解析項目
- 成分名の正規化と認識
- 72種類の成分データベース
- 安全性評価（1-5段階）
- カテゴリー分類
- アレルゲンフラグ
- 機能・効果の説明
- 類似成分の自動検出（編集距離アルゴリズム）
- 解析履歴の保存（最大20件）

#### 解析結果
- 総合安全性スコア（平均値）
- アレルゲン成分の数
- 各成分の詳細情報
- 使用に関する推奨事項

### 3. 製品データベース

#### 収録製品
100種類の多様な化粧品製品を収録：
- 化粧水（20製品）
- 美容液（15製品）
- クリーム（15製品）
- クレンジング（10製品）
- フェイスマスク（10製品）
- 日焼け止め（10製品）
- ファンデーション（10製品）
- その他（10製品）

#### 製品情報
- 製品名、ブランド、カテゴリー
- 価格帯
- 適合肌タイプ
- 主要成分
- ユーザー評価

### 4. 多言語対応

#### 対応言語
- 日本語（デフォルト）
- 英語
- 中国語（簡体字）
- 韓国語

#### 翻訳範囲
- UI要素
- ナビゲーション
- 診断質問と結果
- エラーメッセージ

### 4. 製品検索・フィルタリング機能

#### 概要
100製品から効率的に目的の製品を見つける機能。

#### 検索機能
- テキスト検索（製品名・ブランド名）
- リアルタイム検索（デバウンス機能付き）
- 検索結果の即時表示

#### フィルタリング
- カテゴリー別
- 肌タイプ別
- 価格帯別（5段階）
- 複数条件での絞り込み

#### ソート機能
- 評価順（降順・昇順）
- 価格順（昇順・降順）
- レビュー数順

#### ページネーション
- 12件/ページ表示
- ページ番号ナビゲーション
- 前へ・次へボタン

### 5. PWA機能

#### オフライン対応
Service Workerによる以下のリソースのキャッシュ：
- HTMLファイル
- CSS/JSファイル
- データファイル（JSON）
- アイコン画像

#### インストール可能
- ホーム画面への追加
- スタンドアロンモードでの起動
- アプリアイコンの表示

#### プッシュ通知
- Service Workerによる通知受信
- 通知許可のリクエスト
- テスト通知機能

### 6. データ管理機能

#### エクスポート/インポート
- 診断結果、履歴、お気に入りのエクスポート
- JSON形式でのデータ保存
- ファイルからのデータ復元

#### データ暗号化
- Web Crypto APIを使用した暗号化
- AES-GCM 256bitキー
- 暗号化キーの自動生成と管理
- 既存データのマイグレーション

### 7. アクセシビリティ機能

#### 高コントラストモード
- 視覚障害者向けの高コントラスト表示
- CSS変数による動的テーマ変更
- 境界線の強調表示

#### 文字サイズ調整
- 3段階のフォントサイズ（小・中・大）
- ユーザー設定の保存
- 相対的なサイズ調整

### 8. 設定管理

#### 設定ページ
- 全設定の一元管理
- 直感的なUI/UX
- リアルタイム設定反映

## 技術仕様

### フロントエンド
- **HTML5**: セマンティックマークアップ
- **CSS3**: Flexbox/Grid、CSS変数、メディアクエリ
- **JavaScript**: ES6+、モジュール化、非同期処理

### データ管理
- **LocalStorage**: ユーザー設定、診断履歴、解析履歴
- **JSON**: 製品データ、成分データベース

### パフォーマンス
- **遅延読み込み**: 必要に応じたリソースの読み込み
- **キャッシュ戦略**: Cache First、Network Fallback
- **最適化**: 画像圧縮、コード圧縮
- **検索デバウンス**: 300msの遅延処理
- **ページネーション**: 大量データの分割表示
- **メモリキャッシュ**: 製品・検索結果のキャッシュ

### セキュリティ
- **HTTPS**: 必須（PWA要件）
- **入力検証**: XSS対策
- **プライバシー**: ローカルデータ保存のみ

## UI/UX仕様

### デザイン原則
- **レスポンシブデザイン**: モバイルファースト
- **アクセシビリティ**: WCAG 2.1 AA準拠
- **カラースキーム**: 
  - プライマリ: #ff6b6b
  - セカンダリ: #4ecdc4
  - 背景: #f8f9fa

### ブレークポイント
- モバイル: < 768px
- タブレット: 768px - 1024px
- デスクトップ: > 1024px

### インタラクション
- **トランジション**: 0.3s ease
- **ホバーエフェクト**: 変形、影
- **フィードバック**: 即時応答

## データ仕様

### 診断データ構造
```json
{
  "id": "timestamp",
  "timestamp": "ISO 8601",
  "answers": {
    "skin-type": "string",
    "age-range": "string",
    "skin-concerns": "string",
    "sensitivity": "string",
    "environment": "string",
    "routine-time": "string",
    "budget": "string",
    "ingredient-preference": "string",
    "texture-preference": "string",
    "fragrance": "string"
  },
  "result": {
    "skinType": "string",
    "recommendations": ["string"],
    "productCategories": [{}]
  }
}
```

### 成分データ構造
```json
{
  "成分名": {
    "safety": 1-5,
    "category": "string",
    "description": "string",
    "allergen": boolean,
    "functions": ["string"]
  }
}
```

## テスト仕様

### 単体テスト
- 診断ロジックのテスト
- 成分解析アルゴリズムのテスト
- データ検証のテスト

### 統合テスト
- フォーム送信のテスト
- ローカルストレージのテスト
- 多言語切り替えのテスト

### UIテスト
- レスポンシブデザインのテスト
- ブラウザ互換性テスト
- PWA機能のテスト

## 今後の拡張予定

### 優先度：高
1. **データのエクスポート/インポート機能**: 診断結果や履歴のバックアップ・復元
2. **プッシュ通知**: Web Push APIによる新製品・キャンペーン通知
3. **データの暗号化**: Web Crypto APIによるローカルデータの保護
4. **高コントラストモード**: WCAG AAA準拠のアクセシビリティ強化
5. **文字サイズ調整機能**: ユーザー設定による可変フォントサイズ

### 優先度：中
1. **製品比較機能**: 複数製品の並列比較表示
2. **詳細な製品レビューシステム**: 星評価・テキストレビュー投稿
3. **写真アップロード機能**: 肌状態の画像による診断補助
4. **SNSシェア機能の拡張**: OGPタグ対応、各種SNS連携
5. **バックグラウンド同期**: Service Worker Background Sync API

### 優先度：低
1. **AI肌診断**: TensorFlow.jsによる機械学習診断
2. **AR機能**: WebARによるリアルタイム肌分析
3. **音声入力対応**: Web Speech APIによる音声診断
4. **ダークモード**: CSS変数による動的テーマ切り替え
5. **製品バーコードスキャン**: WebRTC APIによるカメラ読み取り

### 将来的な統合機能
1. **API統合**: 外部製品データベースとの連携
2. **ユーザーアカウント**: クラウド同期
3. **コミュニティ機能**: レビュー、Q&A
4. **EC連携**: 製品購入リンク

## 変更履歴

### v2.1.0 (2025-01-25)
- キーボードナビゲーション機能を実装
- 診断結果画面の大幅改善（回答一覧、推奨理由、スコア表示）
- 未実装機能の整理と優先度付け
- ドキュメントの更新

### v2.0.0 (2025-01-25)
- 製品データベースを100製品に拡張
- 成分データベースを72成分に拡張
- 診断機能を10項目に拡張
- 製品一覧ページを新規追加
- 検索・フィルタリング・ページネーション機能実装
- AIスコアリングによる製品推奨機能
- パフォーマンス最適化

### v1.0.0 (2025-01-25)
- 初回リリース
- 基本機能の実装
- PWA対応
- 多言語対応